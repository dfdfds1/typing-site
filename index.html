<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Typing Practice</title>
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      background: url("KakaoTalk_20250728_132331714.png") no-repeat center 46%;
      background-size: cover;
      background-attachment: fixed;
      font-family: 'Nanum Myeongjo', Georgia, serif;
      overflow: hidden;
    }

    .container {
      position: relative;
      width: 100vw;
      height: 100vh;
    }

    .typing-output {
      position: absolute;
      top: 45%;
      left: 58%;
      width: 34%;
      transform: translate(-50%, -50%);
      font-size: 18px;
      color: #ccc;
      line-height: 1.8;
      white-space: pre-wrap;
      word-break: break-word;
      letter-spacing: 0.03em;
      z-index: 1;
    }

    .typing-output div {
      margin: 0;
      padding: 0;
      line-height: 1.8;
    }

    .typing-output .typed {
      color: #000;
    }

    .typing-input {
      position: absolute;
      bottom: 16%;
      left: 10%;
      width: 80%;
      font-size: 16px;
      padding: 6px;
      background: transparent;
      border: none;
      outline: none;
      color: #555;
      letter-spacing: 0.02em;
      z-index: 1;
    }

    .left-box {
      position: absolute;
      top: 26%;
      left: 11%;
      width: 540px;
      height: 560px;
      cursor: pointer;
      z-index: 2;
    }

    .media-container {
      width: 100%;
      height: 100%;
    }

    .media-container iframe,
    .media-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border: none;
    }

   .mode-btn {
  position: absolute;
  top: 10.6%;     /* 아래로 더 */
  left: 9.5%;     /* 왼쪽으로 더 */
  font-size: 22px;
  padding: 15px 21px;
  background: transparent;
  border: none;
  color: transparent;  /* 글자도 완전 투명 */
  cursor: pointer;
  font-family: 'Nanum Myeongjo', serif;
  z-index: 10;
}


    .mode-btn:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="mode-btn" onclick="loadRandomScript()">문장 연습</button>
    <div class="left-box" onclick="insertMedia()">
      <div class="media-container" id="mediaBox"></div>
    </div>
    <div id="output" class="typing-output"></div>
    <input id="input" class="typing-input" type="text" placeholder="Type here and press Enter..." />
  </div>

  <script>
    const input = document.getElementById("input");
    const output = document.getElementById("output");

    let lines = [];
    let currentLine = 0;
    let practiceMode = false;

    const sentencePool = [
      "햇살 가득한 오후, 그녀는 좋아하는 노래를 들으며 공원 벤치에 앉아 있었다.",
      "시즌을 이해하려는 노력은 사람의 또 다른 이름이다.",
      "그 날의 웃음소리는 아직도 귓가에 선명하다.",
      "작은 새들이 나뭇가지 사이를 날아다니고, 바람은 나뭇잎을 부드럽게 흔들었다.",
      "그 순간만큼은 세상에 혼자 있는 것처럼 고요하고 평화로웠다.",
      "우리는 늘 그렇게 서로를 모른 채 지나치기 일쑤였다.",
      "구속은 늘 그렇게 서서히 단단히 스며들어 온다.",
      "그는 다정한 눈빛으로 나를 바라보며 조용히 말했다.",
      "사랑은 결국 마음을 담아 전하는 작은 행동에서 시작된다.",
      "세상이 어깨를 스치는 정도로 바쁘게 흘러갈 때가 있다.",
      "낯선 거리에서도 익숙한 마음을 발견할 수 있다.",
      "비 내리는 거리를 함께 걷던 그 장면이 자꾸 떠오른다.",
      "내 버리는 기억을 덮고 긴 잠에 자주 머문다.",
      "창밖을 바라보며 흐르는 그 날의 기억은 늘 따뜻하다.",
      "우리는 그렇게 조용히 서로의 마음에 머물렀다."
    ];

    function shuffleAndPick(array, count) {
      const shuffled = array.slice().sort(() => Math.random() - 0.5);
      return shuffled.slice(0, count);
    }

    function loadRandomScript() {
      lines = shuffleAndPick(sentencePool, 15);
      currentLine = 0;
      practiceMode = true;
      renderOutput();
      renderPreview();
    }

    function renderOutput() {
      output.innerHTML = lines.map((line, index) => {
        if (index < currentLine) {
          return `<div class="typed">${line}</div>`;
        } else if (index === currentLine) {
          return `<div id="current-line">${colorizeTypedPortion(line, "")}</div>`;
        } else {
          return `<div>${line}</div>`;
        }
      }).join("");
    }

    function renderPreview() {
      if (practiceMode && currentLine < lines.length) {
        input.value = "";
        input.placeholder = lines[currentLine];
      }
    }

    function colorizeTypedPortion(line, typed) {
      let html = "";
      for (let i = 0; i < line.length; i++) {
        if (typed[i]) {
          html += `<span class="typed">${line[i]}</span>`;
        } else {
          html += `<span>${line[i]}</span>`;
        }
      }
      return html;
    }

    input.addEventListener("input", function () {
      if (!practiceMode || currentLine >= lines.length) return;
      const typed = input.value;
      const correct = lines[currentLine];
      const corrected = correct.slice(0, typed.length);
      const currentEl = document.getElementById("current-line");
      if (currentEl) {
        currentEl.innerHTML = colorizeTypedPortion(correct, corrected);
      }
    });

    input.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        if (practiceMode && currentLine < lines.length) {
          currentLine++;
          if (currentLine === lines.length) {
            setTimeout(() => {
              lines = [];
              output.innerHTML = "";
              input.placeholder = "Type here and press Enter...";
              practiceMode = false;
            }, 800);
          } else {
            renderOutput();
            renderPreview();
          }
        } else {
          const text = input.value.trim();
          if (!text) return;
          input.value = "";
          let i = 0;
          const interval = setInterval(() => {
            if (i < text.length) {
              output.innerHTML += `<span style="color:#000">${text[i]}</span>`;
              i++;
            } else {
              clearInterval(interval);
              output.innerHTML += "<br>";
            }
          }, 40);
        }
      }
    });

    function insertMedia() {
      const url = prompt("GIF 이미지 주소나 YouTube 링크를 입력하세요:");
      const box = document.getElementById("mediaBox");
      if (!url) return;

      if (url.includes("youtube.com") || url.includes("youtu.be")) {
        let embedUrl = url;
        if (url.includes("watch?v=")) {
          const id = url.split("watch?v=")[1].split("&")[0];
          embedUrl = `https://www.youtube.com/embed/${id}`;
        } else if (url.includes("youtu.be")) {
          const id = url.split("youtu.be/")[1];
          embedUrl = `https://www.youtube.com/embed/${id}`;
        }
        box.innerHTML = `<iframe src="${embedUrl}" frameborder="0" allowfullscreen></iframe>`;
      } else if (url.match(/\.(gif|jpg|jpeg|png)$/i)) {
        box.innerHTML = `<img src="${url}" alt="media">`;
      } else {
        alert("지원되지 않는 형식입니다. GIF나 YouTube 링크만 지원됩니다.");
      }
    }
  </script>
</body>
</html>
